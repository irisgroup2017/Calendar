extends layout
mixin timelist()
 -var i = 1
 -var c = 6
 while (i <= 28)
  if i%2 == 0
   td.reserve.time=c +".00"
   -var i = i+1
   -var c = c+1
  else if i == 1
   td.reserve.name(colspan=2) รายชื่อรถยนต์
   -var i = i+1
  else
   td.reserve.half
   -var i = i+1
mixin linetd()
 -var i = 1
 -var c = 6
 while (i <= 28)
  if (i++ <= 1)
   td.reserve-car(colspan=2)
  else
   td.reserve-line
    .reserve-timeline
    if i%2 == 0
     i.fa.fa-circle.reserve-halfdot
    else
     i.fa.fa-dot-circle-o.reserve-fulldot
mixin bodyfill(car,reserve)
 -var a = ["March ฎศ-475","March ฎศ-745","Avanza 2กถ-6841","VIOS 7กล-3404"]
 -var i = 0
 -var id
 for v in a
  -id = car[i++]
  if id == undefined
   tr
    +nulltd(v,null,null)
  else
   tr 
    +nulltd(v,id,reserve)

mixin nulltd(a,b,data)
 -var i = 0
 -var c = 6
 -var first
 -var last 
 -var middle
 if b == null
  while (i++ <= 28)
   if (i == 1)
    td.reserve-car(colspan=2)=a
   else 
    td
 else
  for id in b
   -first = [(first || []),data[id].dayres[0]]
   -last = [(last || []),data[id].dayres[1]]
  while (i++ <= 28)
   if i == 1
    td.reserve-car(colspan=2)=a
   else
    if last.includes(i)
     -middle = false
     td.reserve-time-last
      .timeline-last
    if first.includes(i)
     -middle = true
     td.reserve-time-first
      .timeline-first
    else if middle
     td.reserve-time
      .timeline-middle
    else 
     td
block script
 +ssrc(['jquery-ui.custom.min.js','clockpicker.min.js','jquery.ui.touch-punch.min.js','global.js','moment.min.js','bootbox.min.js','fullcalendar5.5.1.min.js','reserve.js','bootstrap-datepicker.min.js','/fullcalendar5.5.1/th.js'])
 +scss(['animate.min.css','clockpicker.min.css','bootstrap-datepicker.min.css','calendartooltip.css','fileupload.css','reserve.css',"fullcalendar5.5.1.min.css"])
 link(rel='stylesheet' , href='https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.css')
 link(rel='stylesheet' , href='https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.1/css/all.css')

block content
 .row.justify-content-center
  table.reserve-timerange
   caption รายการจองวันนี้
   thead.reserve-rangehead
    tr.sect-time
     +timelist()
    tr.sect-line
     +linetd()
   tbody.reserve-rangebody
    tr
     +bodyfill(parms.car,parms.reserve)
 .row
  .col-sm-9
   .space
   #calendar
  .col-sm-3
   .space
   .widget-box.transparent
    .widget-header
     h4 หมายเหตุ
    .widget-body
     .widget-main.no-padding
      #external-events
       ul
        li.external-event-comment test
         